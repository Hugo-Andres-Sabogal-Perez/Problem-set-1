# Se hace la estimacion por bootstrap:
wage_gap = boot(data=base, FWL_boots, R=100)
wage_gap
stargazer(fwlmod,fwlmod, type="latex", title = "Resultados FWL Simple", out = "Views/modfwl.txt")
ypmod = lm(ln_sal ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm, data=base)
xpmod = lm(Female ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm, data=base)
FWL = data.frame('yprima' = ypmod["residuals"], 'xprima' = xpmod["residuals"])
fwlmod = lm(residuals ~ residuals.1, data = FWL)
stargazer(fwlmod, type="latex", title = "Resultados FWL Simple", out = "Views/modfwl.txt")
FWL_boots <-function(data,index){
ypmod = lm(ln_sal ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm, data, subset=index)
xpmod = lm(Female ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm,data, subset=index)
yprima = ypmod["residuals"]
xprima = xpmod["residuals"]
FWL = data.frame('yprima' = yprima, 'xprima' = xprima)
colnames(FWL)= c("yprima", "xprima")
fwlmod = lm(yprima ~ xprima, data = FWL)
coefs = fwlmod$coefficients[2]
return(coefs)
}
# Se hace la estimacion por bootstrap:
wage_gap = boot(data=base, FWL_boots, R=100)
wage_gap
stargazer(fwlmod,wage_gap, type="latex", title = "Resultados FWL Simple", out = "Views/modfwl.txt")
base_female<- base %>% filter(Female==1)
base_male<-base %>% filter(Female==0)
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario")
predict_plot
base_female<- base %>% filter(Female==1)
base_male<-base %>% filter(Female==0)
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
guide_legend(title="sexo")
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
scale_color_manual(values = c("Masculino" = "steelblue", "Femenino" ="coral2" )) +
guides(color = guide_legend(title = "Sexo", title.hjust = 0.5))
predict_plot
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
guide:legend(title= "Género",  override.aes = list(color = c("steelblue", "coral2")),
legend = "point")
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
guide_legend(title= "Género",  override.aes = list(color = c("steelblue", "coral2")),
legend = "point")
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
guide(title= "Género",  override.aes = list(color = c("steelblue", "coral2")),
legend = "point")
dispersion2 = ggplot(base, aes(x = age, y = ln_sal)) +
geom_point(color = "salmon") +
theme_bw() +
geom_smooth(color = "black", method = "lm", formula = y ~ poly(x, 2)) +
xlab("Edad") +
ylab("Logaritmo del salario por hora")
dispersion2
ggsave("Views/dispersion2.png", width = 6, height = 4,plot=dispersion2)
base_female<- base %>% filter(Female==1)
base_male<-base %>% filter(Female==0)
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario")
predict_plot
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
scale_color_manual(values = c(“Masculino” = “steelblue”, “Grupo 2” = “coral2”))
predict_plot<-ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal), color='steelblue', method = "lm", formula = y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal), color='coral2', method = "lm", formula = y ~ poly(x, 2)) +
theme_bw() +
labs(x = "Edad en años", y = "Logaritmo del salario") +
scale_fill_manual(values = c(“Masculino” = “steelblue”, “Femenino” = “coral2”))
base= DF %>% select(age,oficio, formal, maxEducLevel, orden, p7040, sex, sizeFirm, y_ingLab_m_ha, hoursWorkUsual)
base$ln_sal = log(base$y_ingLab_m_ha) #Se crea el logaritmo del salario por horas para normalizar los valores de la variable.
stargazer(base, type= "text", summary=T, title = "Estadisticas Descriptivas",out = "Views/esta_des.txt")
DF<-import("Stores/DF.csv")
# Se crea una base para guardar las estadisticas descriptivas más relevantes para el trabajo:
vars = length(colnames(DF))
ED = data.frame('Variable' = colnames(DF), 'Missings' = rep(NA, vars), 'Media' =  rep(NA, vars), 'Desviacion Estandard' = rep(NA, vars))
# Se cuentan los missings y se calcula la media y la desviación estándar de la muestra:
for(col in colnames(DF)){
df = DF[,colnames(DF) == col]
NAs = sum(is.na(df))
mean = mean(df, na.rm = T)
sd = sqrt(var(df, na.rm = T))
ED[ED$Variable == col, 2] = NAs
ED[ED$Variable == col, 3] = mean
ED[ED$Variable == col, 4] = sd
}
# 1. Limpieza de datos:
# Se eliminan las constantes (u observaciones que tienen desviación estándar igual a cero) y las variables sin observaciones (missings):
C = ED %>% filter(Desviacion.Estandard == 0 | is.na(Desviacion.Estandard)) %>% select(Variable) %>% as.vector()
ED = ED %>% filter(Desviacion.Estandard != 0 | !is.na(Desviacion.Estandard))
DF = DF[!is.na(DF$y_ingLab_m_ha),]
DF = DF %>% select(-C$Variable)
View(DF)
View(DF)
DF = DF[!is.na(DF$y_ingLab_m_ha),]
View(ED)
View(base)
base= DF %>% select(age,oficio, formal, maxEducLevel, orden, p7040, sex, sizeFirm, y_ingLab_m_ha, hoursWorkUsual)
base$ln_sal = log(base$y_ingLab_m_ha) #Se crea el logaritmo del salario por horas para normalizar los valores de la variable.
stargazer(base, type= "text", summary=T, title = "Estadisticas Descriptivas",out = "Views/esta_des.txt")
histograma_salario <- ggplot(base, aes(x=y_ingLab_m_ha)) +
geom_histogram(color="white",fill="darkblue") +
xlab('Salario por hora') + ylab('Frecuencia') +
theme_bw()
histograma_salario
ggsave("Views/histograma_sal.png", width = 6, height = 4,plot=histograma_salario)
histograma <- ggplot(base, aes(x=ln_sal)) +
geom_histogram(color="white",fill="darkblue") +
xlab('Logaritmo del salario por hora') + ylab('Frecuencia') +
theme_bw()
histograma
ggsave("Views/histograma.png", width = 6, height = 4,plot=histograma)
dispersion = ggplot(base, aes(x=age, y=ln_sal)) + geom_point(color="navy") +
theme_bw() +
geom_smooth(method = 'lm',color="firebrick") +xlab('Edad')+
ylab('Logaritmo del salario por hora')
dispersion
ggsave("Views/dispersion.png", width = 6, height = 4,plot=dispersion)
Salario_sex <- base %>% group_by(sex_factor)  %>%
summarize(mean_sal_sex=mean(y_ingLab_m_ha))
Salario_sex <- base %>% group_by(sex_factor)  %>%
summarize(mean_sal_sex=mean(y_ingLab_m_ha))
Edad <-base %>% group_by(age) %>%
summarize(mean_sal=mean(y_ingLab_m_ha))
barras2 <- ggplot(Edad, aes(x = age, y = mean_sal)) +
geom_bar(width = 0.5, colour ="skyblue", fill = "skyblue", stat = "identity") +
labs(x = "Edad", y = "Salario promedio") +
theme_bw() +
scale_y_continuous(labels = scales::dollar_format())
barras2
ggsave("Views/barras2.png", width = 6, height = 4,plot=barras2)
DF<-import("Stores/DF.csv")
rm(list = ls())
#Llamamos las librerías necesarias para la realización del trabajo
require(pacman)
require(tidyverse)
require(rvest)
require(stargazer)
require(rio)
require(caret)
require(gridExtra)
require(skimr)
require(boot)
require(tidytable)
DF<-import("Stores/DF.csv")
# Se crea una base para guardar las estadisticas descriptivas más relevantes para el trabajo:
vars = length(colnames(DF))
ED = data.frame('Variable' = colnames(DF), 'Missings' = rep(NA, vars), 'Media' =  rep(NA, vars), 'Desviacion Estandard' = rep(NA, vars))
# Se cuentan los missings y se calcula la media y la desviación estándar de la muestra:
for(col in colnames(DF)){
df = DF[,colnames(DF) == col]
NAs = sum(is.na(df))
mean = mean(df, na.rm = T)
sd = sqrt(var(df, na.rm = T))
ED[ED$Variable == col, 2] = NAs
ED[ED$Variable == col, 3] = mean
ED[ED$Variable == col, 4] = sd
}
# 1. Limpieza de datos:
# Se eliminan las constantes (u observaciones que tienen desviación estándar igual a cero) y las variables sin observaciones (missings):
C = ED %>% filter(Desviacion.Estandard == 0 | is.na(Desviacion.Estandard)) %>% select(Variable) %>% as.vector()
ED = ED %>% filter(Desviacion.Estandard != 0 | !is.na(Desviacion.Estandard))
DF = DF[!is.na(DF$y_ingLab_m_ha),]
DF = DF %>% select(-C$Variable)
DF = DF[DF$age!=78,]
DF=DF[!(rownames(DF)%in%c("5733", "579")),]
# 2. Estadisticas descriptivas:
base= DF %>% select(age,oficio, formal, maxEducLevel, orden, p7040, sex, sizeFirm, y_ingLab_m_ha, hoursWorkUsual)
base$ln_sal = log(base$y_ingLab_m_ha) #Se crea el logaritmo del salario por horas para normalizar los valores de la variable.
stargazer(base, type= "text", summary=T, title = "Estadisticas Descriptivas",out = "Views/esta_des.txt")
#Gráficas relevantes para las estadísticas descriptivas
#1. Histograma de la variable Y: salarios por horas
histograma_salario <- ggplot(base, aes(x=y_ingLab_m_ha)) +
geom_histogram(color="white",fill="darkblue") +
xlab('Salario por hora') + ylab('Frecuencia') +
theme_bw()
histograma_salario
ggsave("Views/histograma_sal.png", width = 6, height = 4,plot=histograma_salario)
#2. Histograma de la variable Y: log del salario por hora (transformación)
histograma <- ggplot(base, aes(x=ln_sal)) +
geom_histogram(color="white",fill="darkblue") +
xlab('Logaritmo del salario por hora') + ylab('Frecuencia') +
theme_bw()
histograma
ggsave("Views/histograma.png", width = 6, height = 4,plot=histograma)
#3. Gráfica de Dispersión: Edad vs. Logaritmo del Salario por hora
# El ln(w) es relativamente homocedastico sobre la edad.
dispersion = ggplot(base, aes(x=age, y=ln_sal)) + geom_point(color="navy") +
theme_bw() +
geom_smooth(method = 'lm',color="firebrick") +xlab('Edad')+
ylab('Logaritmo del salario por hora')
dispersion
ggsave("Views/dispersion.png", width = 6, height = 4,plot=dispersion)
#4. Gráfico de Barras: Sexo Vs. Salario Promedio
Salario_sex <- base %>% group_by(sex_factor)  %>%
summarize(mean_sal_sex=mean(y_ingLab_m_ha))
Salario_sex <- base %>% group_by(sex_factor)  %>%
summarize(mean_sal_sex=mean(y_ingLab_m_ha))
barras1 <- ggplot(Salario_sex, aes(x = sex_factor, y = mean_sal_sex)) +
geom_bar(width = 0.5, colour = "skyblue", fill = "skyblue", stat = "identity") +
labs(x = "Sexo", y = "Log del Salario por hora") +
theme_bw() +
scale_y_continuous(labels = scales::dollar_format())
Edad <-base %>% group_by(age) %>%
summarize(mean_sal=mean(y_ingLab_m_ha))
barras2 <- ggplot(Edad, aes(x = age, y = mean_sal)) +
geom_bar(width = 0.5, colour ="skyblue", fill = "skyblue", stat = "identity") +
labs(x = "Edad", y = "Salario promedio") +
theme_bw() +
scale_y_continuous(labels = scales::dollar_format())
barras2
ggsave("Views/barras2.png", width = 6, height = 4,plot=barras2)
base$sex_factor <- factor(base$sex, levels = c(1,0),
labels = c('Masculino', 'Femenino'))
Edad <-base %>% group_by(age) %>%
summarize(mean_sal=mean(y_ingLab_m_ha))
Salario_sex <- base %>% group_by(sex_factor)  %>%
summarize(mean_sal_sex=mean(y_ingLab_m_ha))
barras1 <- ggplot(Salario_sex, aes(x = sex_factor, y = mean_sal_sex)) +
geom_bar(width = 0.5, colour = "skyblue", fill = "skyblue", stat = "identity") +
labs(x = "Sexo", y = "Log del Salario por hora") +
theme_bw() +
scale_y_continuous(labels = scales::dollar_format())
barras1
ggsave("Views/barras1.png", width = 6, height = 4,plot=barras1)
ggsave("Views/barras1.png", width = 6, height = 4,plot=barras1)
base$age_2 <- base$age^2
modelo1 <- lm(ln_sal~age + age_2, data=base)
stargazer(modelo1, type="latex", title = "Resultados Modelo 1", out = "Views/mod1.txt")
modelo1
DF<-import("Stores/DF.csv")
rm(list = ls())
#Llamamos las librerías necesarias para la realización del trabajo
require(pacman)
require(tidyverse)
require(rvest)
require(stargazer)
require(rio)
require(caret)
require(gridExtra)
require(skimr)
require(boot)
require(tidytable)
require(VIM)
require(leaps)
DF<-import("Stores/DF.csv")
# Se crea una base para guardar las estadisticas descriptivas más relevantes para el trabajo:
vars = length(colnames(DF))
ED = data.frame('Variable' = colnames(DF), 'Missings' = rep(NA, vars), 'Media' =  rep(NA, vars), 'Desviacion Estandard' = rep(NA, vars))
# Se cuentan los missings y se calcula la media y la desviación estándar de la muestra:
for(col in colnames(DF)){
df = DF[,colnames(DF) == col]
NAs = sum(is.na(df))
mean = mean(df, na.rm = T)
sd = sqrt(var(df, na.rm = T))
ED[ED$Variable == col, 2] = NAs
ED[ED$Variable == col, 3] = mean
ED[ED$Variable == col, 4] = sd
}
# 1. Limpieza de datos:
# Se eliminan las constantes (u observaciones que tienen desviación estándar igual a cero) y las variables sin observaciones (missings):
C = ED %>% filter(Desviacion.Estandard == 0 | is.na(Desviacion.Estandard)) %>% select(Variable) %>% as.vector()
ED = ED %>% filter(Desviacion.Estandard != 0 | !is.na(Desviacion.Estandard))
ED = ED %>% filter(Variable != 'cuentaPropia')
DF = DF[!is.na(DF$y_ingLab_m_ha),]
DF = DF %>% select(-C$Variable)
DF = DF[DF$age!=78,]
DF=DF[!(rownames(DF)%in%c("5733", "579")),]
# 2. Estadisticas descriptivas:
base= DF %>% select(age,oficio, formal, maxEducLevel, orden, p7040, sex, sizeFirm, y_ingLab_m_ha, hoursWorkUsual)
base$p7040[base$p7040 == 2] <- 0
base$ln_sal = log(base$y_ingLab_m_ha) #Se crea el logaritmo del salario por horas para normalizar los valores de la variable.
stargazer(base, type= "latex", summary=T, title = "Estadisticas Descriptivas",out = "Views/esta_des(latex).tex")
base$age_2 <- base$age^2
modelo1 <- lm(ln_sal~ age+age_2, data=base)
modelo1
stargazer(modelo1,keep.stat = c('rsq', 'adj.rsq') ,type="text", title = "Resultados Modelo 1", out = "Views/mod1(latex).tex")
base$age_2 <- base$age^2
modelo1 <- lm(ln_sal~ age+age_2, data=base)
modelo1
stargazer(modelo1,keep.stat = c('rsq', 'adj.rsq','n') ,type="text", title = "Resultados Modelo 1", out = "Views/mod1(latex).tex")
View(base)
mean(base$age)
rm(list = ls())
#Llamamos las librerías necesarias para la realización del trabajo
require(pacman)
require(tidyverse)
require(rvest)
require(stargazer)
require(rio)
require(caret)
require(gridExtra)
require(skimr)
require(boot)
require(tidytable)
require(VIM)
require(leaps)
DF<-import("Stores/DF.csv")
DF<-import("Stores/DF.csv")
# Se crea una base para guardar las estadisticas descriptivas más relevantes para el trabajo:
vars = length(colnames(DF))
ED = data.frame('Variable' = colnames(DF), 'Missings' = rep(NA, vars), 'Media' =  rep(NA, vars), 'Desviacion Estandard' = rep(NA, vars))
# Se cuentan los missings y se calcula la media y la desviación estándar de la muestra:
for(col in colnames(DF)){
df = DF[,colnames(DF) == col]
NAs = sum(is.na(df))
mean = mean(df, na.rm = T)
sd = sqrt(var(df, na.rm = T))
ED[ED$Variable == col, 2] = NAs
ED[ED$Variable == col, 3] = mean
ED[ED$Variable == col, 4] = sd
}
# 1. Limpieza de datos:
# Se eliminan las constantes (u observaciones que tienen desviación estándar igual a cero) y las variables sin observaciones (missings):
C = ED %>% filter(Desviacion.Estandard == 0 | is.na(Desviacion.Estandard)) %>% select(Variable) %>% as.vector()
ED = ED %>% filter(Desviacion.Estandard != 0 | !is.na(Desviacion.Estandard))
ED = ED %>% filter(Variable != 'cuentaPropia')
DF = DF[!is.na(DF$y_ingLab_m_ha),]
DF = DF %>% select(-C$Variable)
DF = DF[DF$age!=78,]
DF=DF[!(rownames(DF)%in%c("5733", "579")),]
# 2. Estadisticas descriptivas:
base= DF %>% select(age,oficio, formal, maxEducLevel, orden, p7040, sex, sizeFirm, y_ingLab_m_ha, hoursWorkUsual)
base$ln_sal = log(base$y_ingLab_m_ha) #Se crea el logaritmo del salario por horas para normalizar los valores de la variable.
stargazer(base, type= "text", summary=T, title = "Estadisticas Descriptivas",out = "Views/esta_des.txt")
base$age_2 <- base$age^2
modelo1 <- lm(ln_sal~age + age_2, data=base)
stargazer(modelo1, type="latex", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
stargazer(modelo1, type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
base= DF %>% select(age,oficio, formal, maxEducLevel, orden, p7040, sex, sizeFirm, y_ingLab_m_ha, hoursWorkUsual)
base$p7040[base$p7040 == 2] <- 0
base$ln_sal = log(base$y_ingLab_m_ha) #Se crea el logaritmo del salario por horas para normalizar los valores de la variable.
stargazer(base, type= "text", summary=T, title = "Estadisticas Descriptivas",out = "Views/esta_des.txt")
base$age_2 <- base$age^2
modelo1 <- lm(ln_sal~age + age_2, data=base)
stargazer(modelo1, type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
modelo1 <- lm(ln_sal~age+I(age^2), data=base)
stargazer(modelo1, type="latex", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
modelo1 <- lm(ln_sal~age+I(age^2), data=base)
stargazer(modelo1, type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
require(margins)
install.packages('margins')
install.packages("margins")
install.packages('margins')
install.packages("margins")
require(margins)
margins(modelo1)
stargazer(modelo1, margin_effect,type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
require(pacman)
require(tidyverse)
require(rvest)
require(stargazer)
require(rio)
require(caret)
require(gridExtra)
require(skimr)
require(boot)
require(tidytable)
require(VIM)
require(leaps)
require(margins)
stargazer(modelo1, margin_effect,type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
margin_effect<-margins(modelo1)
stargazer(modelo1, margin_effect,type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
margin_effect<-margins(modelo1)
stargazer(modelo1, margin_effect,type="text", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
View(margin_effect)
margins(modelo1)
margins(modelo1)
margins(modelo1)
margins(modelo1)
margins(modelo1)
margins(modelo1)
margins(modelo1)
margin_effect<-margins(modelo1)
print(margins(modelo1))
margin_effect<-margins(modelo1)['se']
margin_effect<-margins(modelo1)
View(margin_effect)
margin_effect<-margins(modelo1,at = "mean")
?margins()
margins(modelo1,at = mean(base$age))
mean(base$age)
margin_effect<-margins(modelo1,at = c(mean(base$age)))
margins(modelo1))
install.packages('marginalEffects')
library(marginalEffects)
install.packages('marginalEffects')
library(marginalEffects)
mar <-  margins(this_model,data = x,type = "response",var = c("female"),
at = list(read = mean(x$read)))
mar <-  margins(modelo1,data = base,type = "response",var = c("age"),
at = list(read = mean(base$age)))
mar <-  margins(modelo1,data = base,type = "response",
at = list(read = mean(base$age)))
mar <-  margins(modelo1,data = base,type = "response",var = c("age")))
mar <-  margins(modelo1,data = base,type = "response")
print(mar)
mar <-  margins(modelo1,data = base,type = "response",
at = list(read = mean(base$read)))
mar <-  margins(modelo1,data = base,type = "response",at = list(read = mean(base$read)))
mar <-  margins(modelo1,data = base,
type = "response",
at = list(age = mean(base$age)))
mar <-  summary(margins(modelo1))
View(mar)
stargazer(modelo1, margin_effect,type="latex", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
stargazer(modelo1, mar,type="latex", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
stargazer(modelo1,type="latex", title = "Resultados Modelo 1", out = "Views/mod1.txt",digits = 5)
margins <-  summary(margins(modelo1))
View(margins)
FWL_boots <-function(data,index){
ypmod = lm(ln_sal ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm, data, subset=index)
xpmod = lm(Female ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm,data, subset=index)
yprima = ypmod["residuals"]
xprima = xpmod["residuals"]
FWL = data.frame('yprima' = yprima, 'xprima' = xprima)
colnames(FWL)= c("yprima", "xprima")
fwlmod = lm(yprima ~ xprima, data = FWL)
coefs = fwlmod$coefficients[2]
return(coefs)
}
# Se hace la estimacion por bootstrap:
wage_gap = boot(data=base, FWL_boots, R=5000)
require(pacman)
require(tidyverse)
require(rvest)
require(stargazer)
require(rio)
require(caret)
require(gridExtra)
require(skimr)
require(boot)
require(tidytable)
require(VIM)
require(leaps)
require(margins)
FWL_boots <-function(data,index){
ypmod = lm(ln_sal ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm, data, subset=index)
xpmod = lm(Female ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm,data, subset=index)
yprima = ypmod["residuals"]
xprima = xpmod["residuals"]
FWL = data.frame('yprima' = yprima, 'xprima' = xprima)
colnames(FWL)= c("yprima", "xprima")
fwlmod = lm(yprima ~ xprima, data = FWL)
coefs = fwlmod$coefficients[2]
return(coefs)
}
# Se hace la estimacion por bootstrap:
wage_gap = boot(data=base, FWL_boots, R=5000)
base$Female <- ifelse(base$sex == 0, 1, 0) #cambiamos la variable sexo dado que ésta inicialmente toma el valor de 1 si la persona es hombre y 0 d.l.c para que tome el valor de 1 si la persona es mujer y 0 d.l.c y así correr el modelo con la que realmente se requiere en las instrucciones
modelo2 <- lm(ln_sal~ Female , data=base)
FWL_boots <-function(data,index){
ypmod = lm(ln_sal ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm, data, subset=index)
xpmod = lm(Female ~ age + factor(maxEducLevel) + formal + factor(oficio) + hoursWorkUsual + p7040 + sizeFirm,data, subset=index)
yprima = ypmod["residuals"]
xprima = xpmod["residuals"]
FWL = data.frame('yprima' = yprima, 'xprima' = xprima)
colnames(FWL)= c("yprima", "xprima")
fwlmod = lm(yprima ~ xprima, data = FWL)
coefs = fwlmod$coefficients[2]
return(coefs)
}
# Se hace la estimacion por bootstrap:
wage_gap = boot(data=base, FWL_boots, R=5000)
set.seed(10101)
wage_gap = boot(data=base, FWL_boots, R=5000)
wage_gap
predict_plot <- ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal, color="Masculino"), method="lm", formula=y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal, color="Femenino"), method="lm", formula=y ~ poly(x, 2)) +
theme_bw() +
labs(x="Edad en años", y="Logaritmo del salario") +
scale_colour_manual(name="Sexo", values=c("Masculino"="steelblue", "Femenino"="coral2"))
base_female<- base %>% filter(Female==1)
base_male<-base %>% filter(Female==0)
predict_plot <- ggplot() +
geom_smooth(data=base_male, aes(x=age, y=ln_sal, color="Masculino"), method="lm", formula=y ~ poly(x, 2)) +
geom_smooth(data=base_female, aes(x=age, y=ln_sal, color="Femenino"), method="lm", formula=y ~ poly(x, 2)) +
theme_bw() +
labs(x="Edad en años", y="Logaritmo del salario") +
scale_colour_manual(name="Sexo", values=c("Masculino"="steelblue", "Femenino"="coral2"))
predict_plot
ggsave("Views/predict_by_zex.pdf", width = 6, height = 4,plot=predict_plot)
